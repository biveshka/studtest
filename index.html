<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Система тестирования</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .screen { display: none; }
        .screen.active { display: block; }
        .test-card { transition: all 0.3s ease; }
        .test-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }
        .answer-option { transition: all 0.2s ease; cursor: pointer; }
        .answer-option:hover { border-color: #3b82f6; background-color: #f8fafc; }
        .answer-option.selected { border-color: #3b82f6; background-color: #dbeafe; color: #1e40af; }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">
                Система тестирования
            </h1>
            <p class="text-lg text-gray-600">
                Простая версия - работает сразу!
            </p>
        </header>

        <div id="app" class="max-w-4xl mx-auto">
            <!-- Экран списка тестов -->
            <div id="test-list-screen" class="screen active">
                <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3" id="tests-container">
                    <!-- Тесты будут загружены здесь -->
                </div>
            </div>

            <!-- Экран теста -->
            <div id="test-screen" class="screen hidden">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span id="progress-text" class="text-sm text-gray-600">Вопрос 1 из 3</span>
                            <span id="points-text" class="text-sm font-semibold text-blue-600">2 балла</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h2 id="question-text" class="text-xl font-semibold text-gray-800 mb-4"></h2>
                        <div id="answers-container" class="space-y-3"></div>
                    </div>

                    <div class="flex justify-between">
                        <button id="prev-btn" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 transition-colors disabled:opacity-50" disabled>Назад</button>
                        <button id="next-btn" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">Далее</button>
                        <button id="submit-btn" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors hidden">Завершить</button>
                    </div>
                </div>
            </div>

            <!-- Экран результатов -->
            <div id="results-screen" class="screen hidden">
                <div class="bg-white rounded-lg shadow-lg p-8 mb-8 text-center">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">Тест завершен!</h2>
                    <div id="score-display" class="text-5xl font-bold mb-4 text-green-600">0 / 0</div>
                    <p id="user-greeting" class="text-lg text-gray-600 mb-2"></p>
                    <p class="text-gray-500">Спасибо за прохождение теста!</p>
                </div>
                <div class="text-center">
                    <button id="back-to-tests-btn" class="bg-blue-600 text-white py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors">
                        Вернуться к тестам
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Вставьте сюда содержимое файла script.js
        // Демо данные для тестов
        const DEMO_TESTS = [
            {
                id: 1,
                title: "Тест по JavaScript",
                description: "Проверьте свои знания JavaScript",
                question_count: 3,
                max_score: 6,
                questions: [
                    {
                        id: 101,
                        question_text: "Что такое closure в JavaScript?",
                        options: ["Функция внутри функции", "Область видимости функции", "Замыкание", "Все варианты"],
                        correct_answer: 2,
                        points: 2
                    },
                    {
                        id: 102,
                        question_text: "Какой метод используется для создания элемента React?",
                        options: ["React.createElement()", "React.newElement()", "React.makeElement()", "React.element()"],
                        correct_answer: 0,
                        points: 2
                    },
                    {
                        id: 103,
                        question_text: "Что возвращает функция useState в React?",
                        options: ["Только значение", "Только функцию обновления", "Массив [значение, функция]", "Объект с значением и функцией"],
                        correct_answer: 2,
                        points: 2
                    }
                ]
            },
            {
                id: 2,
                title: "Тест по HTML/CSS",
                description: "Основы веб-разработки",
                question_count: 2,
                max_score: 4,
                questions: [
                    {
                        id: 201,
                        question_text: "Что означает CSS?",
                        options: ["Computer Style Sheets", "Creative Style System", "Cascading Style Sheets", "Colorful Style Sheets"],
                        correct_answer: 2,
                        points: 2
                    },
                    {
                        id: 202,
                        question_text: "Какой тег используется для создания ссылки?",
                        options: ["<link>", "<a>", "<href>", "<url>"],
                        correct_answer: 1,
                        points: 2
                    }
                ]
            }
        ];

        class SimpleQuizApp {
            constructor() {
                this.tests = DEMO_TESTS;
                this.currentTest = null;
                this.currentQuestionIndex = 0;
                this.userAnswers = {};
                
                this.initializeElements();
                this.attachEventListeners();
                this.showTestList();
            }

            initializeElements() {
                this.screens = {
                    testList: document.getElementById('test-list-screen'),
                    test: document.getElementById('test-screen'),
                    results: document.getElementById('results-screen')
                };

                this.testsContainer = document.getElementById('tests-container');
                this.progressText = document.getElementById('progress-text');
                this.pointsText = document.getElementById('points-text');
                this.progressBar = document.getElementById('progress-bar');
                this.questionText = document.getElementById('question-text');
                this.answersContainer = document.getElementById('answers-container');
                this.prevBtn = document.getElementById('prev-btn');
                this.nextBtn = document.getElementById('next-btn');
                this.submitBtn = document.getElementById('submit-btn');
                this.scoreDisplay = document.getElementById('score-display');
                this.userGreeting = document.getElementById('user-greeting');
                this.backToTestsBtn = document.getElementById('back-to-tests-btn');
            }

            attachEventListeners() {
                this.prevBtn.addEventListener('click', () => this.previousQuestion());
                this.nextBtn.addEventListener('click', () => this.nextQuestion());
                this.submitBtn.addEventListener('click', () => this.submitTest());
                this.backToTestsBtn.addEventListener('click', () => this.showTestList());
            }

            showScreen(screenName) {
                Object.values(this.screens).forEach(screen => {
                    screen.classList.remove('active');
                    screen.classList.add('hidden');
                });

                const targetScreen = this.screens[screenName];
                if (targetScreen) {
                    targetScreen.classList.add('active');
                    targetScreen.classList.remove('hidden');
                    targetScreen.classList.add('fade-in');
                }
            }

            showTestList() {
                this.showScreen('testList');
                this.renderTests();
            }

            renderTests() {
                this.testsContainer.innerHTML = this.tests.map(test => `
                    <div class="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow duration-300 test-card">
                        <h3 class="text-xl font-semibold text-gray-800 mb-3">${test.title}</h3>
                        <p class="text-gray-600 mb-4 line-clamp-2">${test.description}</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-sm text-gray-500">Вопросов: ${test.question_count}</span>
                            <span class="text-sm text-gray-500">Баллов: ${test.max_score}</span>
                        </div>
                        <button 
                            class="test-start-btn w-full bg-blue-600 text-white text-center py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200" 
                            data-test-id="${test.id}"
                        >
                            Начать тест
                        </button>
                    </div>
                `).join('');

                document.querySelectorAll('.test-start-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const testId = parseInt(e.target.dataset.testId);
                        this.startTest(testId);
                    });
                });
            }

            startTest(testId) {
                this.currentTest = this.tests.find(test => test.id === testId);
                this.currentQuestionIndex = 0;
                this.userAnswers = {};
                this.showTestQuestion();
            }

            showTestQuestion() {
                this.showScreen('test');
                const question = this.currentTest.questions[this.currentQuestionIndex];
                
                const progress = ((this.currentQuestionIndex + 1) / this.currentTest.questions.length) * 100;
                this.progressText.textContent = `Вопрос ${this.currentQuestionIndex + 1} из ${this.currentTest.questions.length}`;
                this.pointsText.textContent = `${question.points} баллов`;
                this.progressBar.style.width = `${progress}%`;
                
                this.questionText.textContent = question.question_text;
                
                this.answersContainer.innerHTML = question.options.map((option, index) => `
                    <div class="answer-option w-full text-left p-4 rounded-lg border-2 transition-all duration-200 ${
                        this.userAnswers[question.id] === index 
                            ? 'border-blue-500 bg-blue-50 text-blue-700 selected' 
                            : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'
                    }" data-question-id="${question.id}" data-answer-index="${index}">
                        ${option}
                    </div>
                `).join('');

                this.answersContainer.querySelectorAll('.answer-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const questionId = parseInt(e.currentTarget.dataset.questionId);
                        const answerIndex = parseInt(e.currentTarget.dataset.answerIndex);
                        this.selectAnswer(questionId, answerIndex);
                    });
                });

                this.prevBtn.disabled = this.currentQuestionIndex === 0;
                
                if (this.currentQuestionIndex === this.currentTest.questions.length - 1) {
                    this.nextBtn.classList.add('hidden');
                    this.submitBtn.classList.remove('hidden');
                } else {
                    this.nextBtn.classList.remove('hidden');
                    this.submitBtn.classList.add('hidden');
                }
            }

            selectAnswer(questionId, answerIndex) {
                this.userAnswers[questionId] = answerIndex;
                
                this.answersContainer.querySelectorAll('.answer-option').forEach(option => {
                    const optionQuestionId = parseInt(option.dataset.questionId);
                    const optionAnswerIndex = parseInt(option.dataset.answerIndex);
                    
                    if (optionQuestionId === questionId) {
                        if (optionAnswerIndex === answerIndex) {
                            option.classList.add('selected');
                        } else {
                            option.classList.remove('selected');
                        }
                    }
                });
            }

            previousQuestion() {
                if (this.currentQuestionIndex > 0) {
                    this.currentQuestionIndex--;
                    this.showTestQuestion();
                }
            }

            nextQuestion() {
                if (this.currentQuestionIndex < this.currentTest.questions.length - 1) {
                    this.currentQuestionIndex++;
                    this.showTestQuestion();
                }
            }

            calculateScore() {
                let score = 0;
                this.currentTest.questions.forEach(question => {
                    const userAnswer = this.userAnswers[question.id];
                    if (userAnswer !== undefined && question.correct_answer === userAnswer) {
                        score += question.points;
                    }
                });
                return score;
            }

            submitTest() {
                const score = this.calculateScore();
                const maxScore = this.currentTest.max_score;
                const percentage = Math.round((score / maxScore) * 100);

                let scoreColor = 'text-red-600';
                if (percentage >= 80) scoreColor = 'text-green-600';
                else if (percentage >= 60) scoreColor = 'text-yellow-600';

                this.scoreDisplay.textContent = `${score} / ${maxScore}`;
                this.scoreDisplay.className = `text-5xl font-bold mb-4 ${scoreColor}`;
                this.userGreeting.textContent = `Ваш результат: ${percentage}%`;

                this.showScreen('results');
            }
        }

        // Запуск приложения
        document.addEventListener('DOMContentLoaded', () => {
            new SimpleQuizApp();
        });
    </script>
</body>
</html>